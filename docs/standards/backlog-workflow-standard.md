# Стандарт работы с задачами беклога

**Версия:** 1.0
**Дата:** 2025-12-26
**Статус:** ОБЯЗАТЕЛЬНЫЙ

## Типы задач

| Тип | Расположение | Папка результатов |
|-----|--------------|-------------------|
| Обычные задачи | `docs/backlog/tasks/` | `docs/solutions/` |
| Технический долг | `docs/backlog/technical-debt/` | `docs/bugs/` |

---

## Обычные задачи

### Начало работы

1. **Создать ветку:**
   ```bash
   git checkout -b feature/[номер]-[название]
   ```

2. **Создать папку задачи:**
   ```bash
   mkdir -p docs/solutions/[номер]-[название]
   ```

3. **Скопировать файл задачи** в папку (без изменений):
   ```bash
   cp docs/backlog/tasks/[номер]-[название].md docs/solutions/[номер]-[название]/
   ```

4. **Создать файл истории решений:**
   ```bash
   touch docs/solutions/[номер]-[название]/decisions.md
   ```

### Структура папки задачи

```
docs/solutions/[номер]-[название]/
├── [номер]-[название].md    # Оригинальный файл задачи (ТЗ)
└── decisions.md             # История решений
```

### Файл decisions.md

```markdown
# Decisions: [Название задачи]

## Контекст
[Краткое описание исходной ситуации]

## Принятые решения
[Ключевые решения и почему они были приняты]

## Что реализовано
- [x] Пункт 1
- [x] Пункт 2

## Что НЕ реализовано (если есть)
- [ ] Пункт → создан TD-XXX

## Технические детали
[Важное для понимания реализации]
```

### Перед завершением

- [ ] Все подзадачи из файла задачи выполнены или вынесены в tech debt
- [ ] Запущен `/check-code`
- [ ] Пройдены проверки: `npm run lint && npm run typecheck && npm test`
- [ ] Удалён файл задачи из `docs/backlog/tasks/`
- [ ] Обновлён `docs/backlog/README.md` (статус DONE, ссылка на solutions)
- [ ] Создан коммит и выполнен merge в main

### Завершение

```bash
# Удалить из backlog
rm docs/backlog/tasks/[номер]-[название].md

# Коммит и merge
git add .
git commit -m "feat([номер]): [описание]"
git checkout main
git merge feature/[номер]-[название]
```

---

## Задачи технического долга

### Начало работы

1. **Создать ветку:**
   ```bash
   git checkout -b fix/[название]
   ```

2. **Выполнить исправление**

3. **Создать файл истории:**
   ```bash
   touch docs/bugs/[YYYY-MM-DD]-[название].md
   ```

### Структура docs/bugs/

```
docs/bugs/
├── 2025-12-26-service-unit-tests.md
├── 2025-12-27-redis-connection-fix.md
└── ...
```

### Формат файла истории

```markdown
# [Название проблемы]

**Дата:** YYYY-MM-DD
**Источник:** TD-XXX (если был)

## Проблема

[Что было не так, как проявлялось]

## Причина

[Почему возникла проблема]

## Решение

[Что было сделано для исправления]

## Изменённые файлы

- `path/to/file1.ts` — [что изменено]
- `path/to/file2.ts` — [что изменено]

## Важно для разработчика

[Ключевая информация для быстрого понимания:
- Изменившаяся логика
- На что обратить внимание
- Связанные компоненты]
```

### Перед завершением

- [ ] Проблема исправлена и проверена
- [ ] Запущен `/check-code`
- [ ] Пройдены проверки: `npm run lint && npm run typecheck && npm test`
- [ ] Создан файл истории в `docs/bugs/`
- [ ] Удалён файл из `docs/backlog/technical-debt/`
- [ ] Создан коммит и выполнен merge в main

### Завершение

```bash
# Удалить из backlog
rm docs/backlog/technical-debt/td-XXX-[название].md

# Коммит и merge
git add .
git commit -m "fix: [описание исправления]"
git checkout main
git merge fix/[название]
```

---

## Примеры

### Пример: обычная задача

```
Задача: 018-tests

docs/solutions/018-tests/
├── 018-tests.md      # Оригинальное ТЗ
└── decisions.md      # Решения: ESM/Prisma проблема, что покрыто тестами
```

### Пример: технический долг

```
Задача: td-021-service-unit-tests

docs/bugs/2025-12-26-service-unit-tests.md
# Содержит: проблему ESM, решение через Vitest, изменённые файлы
```

---

## Связь с другими стандартами

- `git-workflow-standard.md` — правила работы с git
- `tdd-standard.md` — если задача требует написания тестов
- `GLOBAL-implementation-standard.md` — общие принципы разработки
