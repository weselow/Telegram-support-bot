# Задача 017: Обработка блокировки бота

**Этап:** 5 - Полировка
**Статус:** TODO
**Приоритет:** Низкий

## Описание

Корректно обрабатывать ситуацию, когда пользователь заблокировал бота.

## Подзадачи

- [ ] Определение ошибки блокировки:
  - [ ] Код ошибки Telegram API (403 Forbidden)
  - [ ] Текст ошибки "bot was blocked by the user"
- [ ] Обработка в message.service.ts:
  - [ ] Catch ошибки при отправке
  - [ ] Уведомление в топик
  - [ ] Логирование в Sentry
- [ ] Формат уведомления в топике:
  - [ ] «⚠️ Пользователь заблокировал бота, сообщение не доставлено»
- [ ] Не менять статус тикета (пусть сотрудник решит)

## Зависимости

- [007-mirror-topic-to-user](./007-mirror-topic-to-user.md)
- [016-sentry-integration](./016-sentry-integration.md)

## Результат

- Сотрудники видят что сообщение не доставлено
- Ошибка логируется
- Бот не падает

---

## Начало работы

### 1. Создай ветку

```bash
git checkout -b feature/017-bot-blocked-handling
```

### 2. Создай папку для решений

```bash
mkdir -p docs/solutions/017-bot-blocked-handling
```

### 3. Веди историю решений

В файле `docs/solutions/017-bot-blocked-handling/decisions.md` записывай:
- Формат уведомления
- Нужно ли менять статус
- Как обрабатывать разблокировку

### 4. Перед завершением — код-ревью

Запусти команду `/check-code` для проверки кода перед мержем.

### 5. Перед коммитом

- [ ] Проверь, что все подзадачи из этого файла выполнены
- [ ] Обнови статус задачи на `DONE`
- [ ] Перемести этот файл в `docs/solutions/017-bot-blocked-handling/`

### 6. По завершении

```bash
git add .
git commit -m "feat(017): обработка блокировки бота"
git checkout main
git merge feature/017-bot-blocked-handling
```
