# –†–µ—à–µ–Ω–∏—è –ø–æ –∑–∞–¥–∞—á–µ 013: SLA-—Ç–∞–π–º–µ—Ä—ã

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SLA

### –£—Ä–æ–≤–Ω–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- **first** (10 –º–∏–Ω—É—Ç): `‚è∞ SLA: 10 –º–∏–Ω—É—Ç –±–µ–∑ –æ—Ç–≤–µ—Ç–∞` + –ø–∏–Ω–≥ –∞–¥–º–∏–Ω–æ–≤
- **second** (30 –º–∏–Ω—É—Ç): `‚ö†Ô∏è SLA: 30 –º–∏–Ω—É—Ç –±–µ–∑ –æ—Ç–≤–µ—Ç–∞` + –ø–∏–Ω–≥ –∞–¥–º–∏–Ω–æ–≤
- **escalation** (2 —á–∞—Å–∞): `üö® SLA BREACH: 2 —á–∞—Å–∞ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞!` + –ø–∏–Ω–≥ –∞–¥–º–∏–Ω–æ–≤ + DM –∞–¥–º–∏–Ω–∞–º

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
–í—Å–µ SLA-—Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `//` ‚Äî —ç—Ç–æ internal-—Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ support.ts).

### –ü–∏–Ω–≥ –∞–¥–º–∏–Ω–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `getChatAdministrators` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∞–¥–º–∏–Ω–æ–≤ –≥—Ä—É–ø–ø—ã
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `@username` –∏–ª–∏ `[–∏–º—è](tg://user?id=123)` –¥–ª—è —Ç–µ—Ö, —É –∫–æ–≥–æ –Ω–µ—Ç username
- –ë–æ—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞

### DM –ø—Ä–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
–ü—Ä–∏ breach (2 —á–∞—Å–∞) –∫–∞–∂–¥–æ–º—É –∞–¥–º–∏–Ω—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ —Ç–∏–∫–µ—Ç.
–ï—Å–ª–∏ –±–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω —É –∞–¥–º–∏–Ω–∞ ‚Äî –æ—à–∏–±–∫–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å.

### –õ–æ–≥–∏–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤
1. **–ó–∞–ø—É—Å–∫**: –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∏–∫–µ—Ç–∞ –∏–ª–∏ –ø–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç–∏–∏ (status ‚Üí NEW/REOPENED)
2. **–û—Ç–º–µ–Ω–∞**: –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–æ–ø–∏–∫–µ)
3. **–ù–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**: –ø—Ä–∏ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∫–ª–∏–µ–Ω—Ç–∞ (SLA —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è)

### Job ID —Ñ–æ—Ä–º–∞—Ç
`sla-{userId}-{topicId}-{level}` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è –æ—Ç–º–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞.

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### group.service.ts
- `getGroupAdmins(api)` ‚Äî –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ –≥—Ä—É–ø–ø—ã
- `formatAdminMentions(admins)` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –¥–ª—è Markdown
- `sendDmToAdmins(api, admins, message)` ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DM –∫–∞–∂–¥–æ–º—É –∞–¥–º–∏–Ω—É

### sla.service.ts
- `startSlaTimers(userId, topicId)` ‚Äî –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ 3 —É—Ä–æ–≤–Ω—è
- `cancelAllSlaTimers(userId, topicId)` ‚Äî –æ—Ç–º–µ–Ω—è–µ—Ç –≤—Å–µ —Ç–∞–π–º–µ—Ä—ã –¥–ª—è —Ç–∏–∫–µ—Ç–∞

### sla.worker.ts
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Ç–∏–∫–µ—Ç –Ω–µ –∑–∞–∫—Ä—ã—Ç (status !== CLOSED)
- –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–æ–ø–∏–∫ —Å –ø–∏–Ω–≥–∞–º–∏
- –ü—Ä–∏ escalation ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ DM –∞–¥–º–∏–Ω–∞–º
- –õ–æ–≥–∏—Ä—É–µ—Ç SLA-—Å–æ–±—ã—Ç–∏—è

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- `message.ts`: startSlaTimers –ø–æ—Å–ª–µ createTicket –∏ –ø—Ä–∏ reopen
- `support.ts`: cancelAllSlaTimers –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
